{"ast":null,"code":"import React,{useEffect,useState,useRef}from\"react\";import{useLocation}from\"react-router-dom\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const QuizResults=()=>{const location=useLocation();const{quiz,answers,user}=location.state;const[resultsSaved,setResultsSaved]=useState(false);// Flag to track if results are saved\nconst saveResultsCalled=useRef(false);// Ref to track if saveResults has been called\n// Calculate the score\nconst score=quiz.questions.reduce((acc,question,index)=>{var _question$options$fin;const correctAnswer=(_question$options$fin=question.options.find(opt=>opt.isCorrect))===null||_question$options$fin===void 0?void 0:_question$options$fin.text;if(answers[index]===correctAnswer){return acc+1;}return acc;},0);useEffect(()=>{// Save the results to the database\nconst saveResults=async()=>{try{const userName=(user===null||user===void 0?void 0:user.name)||\"Default User\";// Provide a default user name if undefined\nconsole.log(\"Sending data to server:\",{user:userName,category:quiz.category,score:score});await axios.post(\"http://localhost:4000/quiz/save-results\",{user:userName,category:quiz.category,score:score});console.log(\"Results saved successfully\");setResultsSaved(true);// Set the flag to true after saving results\n}catch(error){console.error(\"Error saving results:\",error);}};if(!resultsSaved&&!saveResultsCalled.current){saveResultsCalled.current=true;// Set the ref to true to prevent multiple calls\nsaveResults();}},[quiz.category,score,user,resultsSaved]);return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col min-h-screen\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto p-8 flex-grow\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold mb-6\",children:\"Quiz Results\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:quiz.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-4\",children:[\"Difficulty: \",quiz.difficulty]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold mb-4\",children:[\"Your Score: \",score,\" / \",quiz.questions.length]}),quiz.questions.map((question,index)=>{var _question$options$fin2;return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8 p-4 bg-white shadow-lg rounded-lg\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold\",children:[index+1,\". \",question.title]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Your Answer:\"}),\" \",answers[index]]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Correct Answer:\"}),\" \",((_question$options$fin2=question.options.find(opt=>opt.isCorrect))===null||_question$options$fin2===void 0?void 0:_question$options$fin2.text)||\"No correct answer available\"]})]},index);})]}),/*#__PURE__*/_jsx(\"footer\",{className:\"bg-gray-800 text-white p-4 text-center mt-auto\",children:/*#__PURE__*/_jsx(\"p\",{children:\"\\xA9 2025 Quiz App. All rights reserved.\"})})]});};export default QuizResults;","map":{"version":3,"names":["React","useEffect","useState","useRef","useLocation","axios","jsx","_jsx","jsxs","_jsxs","QuizResults","location","quiz","answers","user","state","resultsSaved","setResultsSaved","saveResultsCalled","score","questions","reduce","acc","question","index","_question$options$fin","correctAnswer","options","find","opt","isCorrect","text","saveResults","userName","name","console","log","category","post","error","current","className","children","title","difficulty","length","map","_question$options$fin2"],"sources":["C:/Users/RAGHAVENDRA/Downloads/MERN-Quiz-App-main/MERN-Quiz-App-main/Frontend_MERN_Quize_App/src/Pages/QuizResults.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\n\r\nconst QuizResults = () => {\r\n  const location = useLocation();\r\n  const { quiz, answers, user } = location.state;\r\n  const [resultsSaved, setResultsSaved] = useState(false); // Flag to track if results are saved\r\n  const saveResultsCalled = useRef(false); // Ref to track if saveResults has been called\r\n\r\n  // Calculate the score\r\n  const score = quiz.questions.reduce((acc, question, index) => {\r\n    const correctAnswer = question.options.find(opt => opt.isCorrect)?.text;\r\n    if (answers[index] === correctAnswer) {\r\n      return acc + 1;\r\n    }\r\n    return acc;\r\n  }, 0);\r\n\r\n  useEffect(() => {\r\n    // Save the results to the database\r\n    const saveResults = async () => {\r\n      try {\r\n        const userName = user?.name || \"Default User\"; // Provide a default user name if undefined\r\n        console.log(\"Sending data to server:\", { user: userName, category: quiz.category, score: score });\r\n        await axios.post(\"http://localhost:4000/quiz/save-results\", {\r\n          user: userName,\r\n          category: quiz.category,\r\n          score: score,\r\n        });\r\n        console.log(\"Results saved successfully\");\r\n        setResultsSaved(true); // Set the flag to true after saving results\r\n      } catch (error) {\r\n        console.error(\"Error saving results:\", error);\r\n      }\r\n    };\r\n\r\n    if (!resultsSaved && !saveResultsCalled.current) {\r\n      saveResultsCalled.current = true; // Set the ref to true to prevent multiple calls\r\n      saveResults();\r\n    }\r\n  }, [quiz.category, score, user, resultsSaved]);\r\n\r\n  return (\r\n    <div className=\"flex flex-col min-h-screen\">\r\n      <div className=\"container mx-auto p-8 flex-grow\">\r\n        <h1 className=\"text-3xl font-bold mb-6\">Quiz Results</h1>\r\n        <h2 className=\"text-xl font-bold mb-4\">{quiz.title}</h2>\r\n        <p className=\"text-gray-600 mb-4\">Difficulty: {quiz.difficulty}</p>\r\n        <p className=\"text-2xl font-bold mb-4\">Your Score: {score} / {quiz.questions.length}</p>\r\n\r\n        {quiz.questions.map((question, index) => (\r\n          <div key={index} className=\"mb-8 p-4 bg-white shadow-lg rounded-lg\">\r\n            <h3 className=\"text-lg font-semibold\">{index + 1}. {question.title}</h3>\r\n            <p><strong>Your Answer:</strong> {answers[index]}</p>\r\n            <p><strong>Correct Answer:</strong> {question.options.find(opt => opt.isCorrect)?.text || \"No correct answer available\"}</p>\r\n          </div>\r\n        ))}\r\n      </div>\r\n      <footer className=\"bg-gray-800 text-white p-4 text-center mt-auto\">\r\n        <p>&copy; 2025 Quiz App. All rights reserved.</p>\r\n      </footer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default QuizResults;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}